<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>


<article-meta>


<title-group>
<article-title>Arizona Random Forest Flood Mapping</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0009-0006-0181-3099</contrib-id>
<name>
<surname>Zalesky</surname>
<given-names>Travis</given-names>
</name>
<string-name>Travis Zalesky</string-name>

<email>travisz@arizona.edu</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>University of Arizona</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">travisz@arizona.edu</corresp>
</author-notes>









<history></history>


<abstract>
<p>Federal Emergency Management Administration 100-year flood risk maps
are expanded across the state of Arizona using a random forest, machine
learning classification utilizing eight topographic explanatory
variables.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Arizona</kwd>
<kwd>Flood</kwd>
<kwd>Federal Emergency Management Administration</kwd>
<kwd>Random Forest</kwd>
<kwd>Machine Learning</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="background">
  <title>1 Background</title>
  <p>A critical component of the Arizona Tri-University Recharge (ATUR)
  project is a state wide assessment of flooding potential. Initial
  efforts focused on a traditional suitability analysis approach, using
  the analytical hierarchy process (AHP) for multi-criterion decision
  making, largely based on the work by Aloui et al.
  (<xref alt="2024" rid="ref-Aloui_Zghibi_Mazzoni_Elomri_Al-Ansari_2024" ref-type="bibr">2024</xref>).
  These methods saw initial success, and are continuing to be developed
  and refined. However, it became apparent that there were a number of
  shortcomings inherent in this approach which are not easily
  addressed.</p>
  <p>Firstly, the results of such an analysis are intrinsically linked
  to the data layers used, and the weighting schema determined by the
  AHP. As additional data sets became available, and alternate weighting
  schemas were tested we generated multiple versions of mapped flood
  potential which did not necessarily agree with each other
  (<xref alt="Figure 1" rid="fig-suitComp">Figure 1</xref>). In the
  absence of high quality ground-truthed data it was difficult to
  validate these results and it was not clear to the project team which
  version was the best. This underscores the need for expert involvement
  at every stage of AHP based analysis. While there is a wealth of
  hydrological expertise within the larger ATUR project, development and
  implementation of this process has largely been conducted by a GIS
  technician with marginal hydrologic knowledge, and it has been
  difficult to foster sustained buy-in from team members on this portion
  of the project.</p>
  <fig id="fig-suitComp">
    <caption><p>Figure 1: Side-by-side comparison of two versions of a
    flooding susceptibility analysis for the San Pedro watershed showing
    subtle differences as the result of updated layers and weighting
    schemas. Map A uses 9 input layers, while map B uses 8, removing one
    data layer, and exchanging another. For full details of method
    differences see
    <ext-link ext-link-type="uri" xlink:href="https://travisz09.github.io/SanPedro_Flood-MAR/">San
    Pedro Flood-MAR</ext-link>, as well as
    <ext-link ext-link-type="uri" xlink:href="https://arizona.box.com/s/0pn7q3411aatq7mwohlk1t3a3a0edly2">Flood-MAR
    V2</ext-link> (login required).</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/SanPedro_V1vsV2.png" />
  </fig>
  <p>Furthermore, it was extremely difficult to develop a single
  generalized model that would be effective across the whole state.
  Because of the wide array of ecological and geologic conditions that
  are present across the state, variables that are important for flood
  risk in one region may not apply in other regions. Lastly, even if
  these technical issues could be overcome, there was still gaps in the
  input data layers, resulting in unclassified regions.</p>
  <p>While the traditional suitability analysis methods of assessing
  flood potential is still valuable to the project, and will be retained
  and developed further, the reality of these challenges lead us to
  reevaluate our overall approach and consider alternate methods. Work
  by Mudashiru et al.
  (<xref alt="2021" rid="ref-Mudashiru_Sabtu_Abustan_Balogun_2021" ref-type="bibr">2021</xref>)
  summarized the various methods used by other researchers in this
  field, which includes AHP based methods as well as physical modeling
  and machine learning applications. The machine learning methods
  utilized by Tehrany et al.
  (<xref alt="2019" rid="ref-Tehrany_Jones_Shabani_2019" ref-type="bibr">2019</xref>)
  appeared to be particularly relevant. Specifically, their use of
  topographic data <bold>only</bold> was particularly intriguing. These
  data sets are fully derived from digital elevation models (DEMs),
  which are easily accessible, and have full coverage over the study
  area. These findings lead to a renewed initiative to apply a machine
  learning based method towards the objective of a state wide flood
  map.</p>
</sec>
<sec id="sec-data-methods">
  <title>2 Data &amp; Methods</title>
  <sec id="topography-data">
    <title>2.1 Topography Data</title>
    <p>All explanatory variables for the model were derived from the
    NASA Shuttle Radar Topography Mission (SRTM) 30 m DEM. Slope,
    aspect, curvature, stream power index (SPI), topographic wetness
    index (TWI), and sediment transport index (STI) were all calculated
    in ArcGIS Pro (3.4.3). Slope, aspect and curvature were calculated
    using the Surface Parameters tool (Spatial Analyst). SPI, TWI, and
    STI were calculated as per Tehrany et al.
    (<xref alt="2019" rid="ref-Tehrany_Jones_Shabani_2019" ref-type="bibr">2019</xref>)
    using the Raster Calculator tool according to Equations
    <xref alt="1" rid="eq-spi">1</xref>-<xref alt="3" rid="eq-sti">3</xref></p>
    <p><styled-content id="eq-spi"><disp-formula><alternatives>
    <tex-math><![CDATA[
    SPI = A_s * tan(ß)
     \qquad(1)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>*</mml:mo><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ß</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p><styled-content id="eq-twi"><disp-formula><alternatives>
    <tex-math><![CDATA[
    TWI = ln(A_s / tan(ß))
     \qquad(2)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>T</mml:mi><mml:mi>W</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ß</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p><styled-content id="eq-sti"><disp-formula><alternatives>
    <tex-math><![CDATA[
    STI = (A_s / 22.13)^{0.6} * (sin(ß)/0.0896)^{1.3}
     \qquad(3)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:mn>22.13</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>0.6</mml:mn></mml:msup><mml:mo>*</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ß</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>/</mml:mi><mml:mn>0.0896</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>1.3</mml:mn></mml:msup><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p>where A<sub>s</sub> is the catchment area (m) and ß is the slope
    (radians).</p>
    <p>Similarly, Topographic Roughness Index (TRI) was calculated as
    per Tehrany et al.
    (<xref alt="2019" rid="ref-Tehrany_Jones_Shabani_2019" ref-type="bibr">2019</xref>)
    using a custom R (4.4.1) function with the package terra (1.7-78)
    according to
    <xref alt="Equation 4" rid="eq-tri">Equation 4</xref></p>
    <p><styled-content id="eq-tri"><disp-formula><alternatives>
    <tex-math><![CDATA[
    TRI = \left[ \sum (χ_{ij} - χ_{00})^2 \right] ^{0.5}
     \qquad(4)]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mo>∑</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>χ</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mn>0.5</mml:mn></mml:msup><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
    <p>where χ<sub>ij</sub> is the elevation at coordinates (i, j) and
    χ<sub>00</sub> is the elevation at coordinates (0, 0) for a 3x3
    focal neighborhood. The code used to calculate TRI is available on
    <ext-link ext-link-type="uri" xlink:href="https://github.com/travisz09/TopographicRoughnessIndex">GitHub</ext-link>.</p>
  </sec>
  <sec id="flooding-data">
    <title>2.2 Flooding Data</title>
    <p>Flood data used for training the model was obtained from the
    Federal Emergency Management Administration (FEMA) National Flood
    Hazards Layer, which provides 100-year flood maps for many areas of
    the US. The data was manually downloaded for each county in AZ from
    the FEMA
    <ext-link ext-link-type="uri" xlink:href="https://hazards-fema.maps.arcgis.com/apps/webappviewer/index.html?id=8b0adb51996444d4879338b5529aa9cd">data
    viewer</ext-link> (accessed 3/15/2025). Data layers were merged in
    ArcGIS Pro (3.4.3), and the vector data was converted to a raster
    with a 10 m resolution. Additionally, the FEMA data was reclassified
    to a binary output, either flooded or not flooded (during a 100-year
    flood event), eliminating superfluous details such as survey methods
    and flow depth
    (<xref alt="Figure 2" rid="fig-fema">Figure 2</xref>).</p>
    <fig id="fig-fema">
      <caption><p>Figure 2: Simplified FEMA 100-year flood map for all
      counties in Arizona.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="images/FEMA2.png" />
    </fig>
  </sec>
  <sec id="google-earth-engine-preparation">
    <title>2.3 Google Earth Engine Preparation</title>
    <p>The machine learning model was performed in Google Earth Engine
    (GEE). The SRTM elevation data was access and clipped to the study
    area natively through GEE servers, all other data layers, including
    the study area shapefile, were uploaded as an asset to GEE prior to
    model implementation.</p>
  </sec>
  <sec id="variable-collinearity">
    <title>2.4 Variable Collinearity</title>
    <p>Prior to modeling, the collinearity of the explanatory variables
    was explored using a series of pair-wise linear regressions (Figures
    <xref alt="A1" rid="appfig-floodElev">A1</xref>-<xref alt="A36" rid="appfig-triSti">A36</xref>).
    5,000 points (the maximum number of points which can be plotted in
    GEE) were randomly sampled across the study area for collinearity
    analysis. The collinearity of each pair-wise regression is
    summarized visually in
    <xref alt="Figure 3" rid="fig-Rsquared">Figure 3</xref> using the
    R-squared statistic of each comparison. While some relationships,
    e.g. slope and TWI (Figure
    <xref alt="A19" rid="appfig-slopeTwi">A19</xref>), share a complex
    relationship that is not captured by a linear regression, the
    R-squared statistic is a simple indicator of collinearity which is
    readily understood. Although a formal variance inflation factor
    (VIF) analysis was not performed, efforts were made to limit model
    complexity by manually testing variable combinations, especially
    those that showed high degrees of collinearity, and at equivalent
    model accuracy, simpler models were preferred.</p>
    <fig id="fig-Rsquared">
      <caption><p>Figure 3: Color coded R-squared statistic for each
      pair-wise linear regression (green = high, red = low),
      representing the collinearity of each variable used for
      modeling.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="images/CorrelationMatrix.PNG" />
    </fig>
  </sec>
  <sec id="initial-model-testing-and-development">
    <title>2.5 Initial Model Testing and Development</title>
    <p>Many models were iteratively explored using several machine
    learning algorithms, various combinations of explanatory variables,
    and many hyperparameterization values. For all initial model trials
    the study area was reduced to the San Pedro watershed, a well
    characterized watershed with approx. 66% FEMA flood map coverage
    (visual estimate). A 70:30::training:testing data structure was
    adopted, and while a range of sampled points were tested, this ratio
    was maintained throughout. Model performance was primarily assessed
    through an overall accuracy score, with confusion matrix analysis
    performed for highly accurate models.</p>
    <p>Tested models included Classification and Regression Tree (CART,
    a.k.a Decision Tree), Random Forest (RF), and Support Vector Machine
    (SVM). Generally, CART classification produced very noisy results
    which tended to overestimate flood waters, and averaged around 79.5%
    accuracy (data not shown). SVM classification was too
    computationally demanding, even within the smaller study area of the
    San Pedro, and given the generous cloud computing resources of GEE.
    As a consequence SVM classification can not be evaluated, other than
    to say that it is inefficient and implementation is impractical. RF
    classification proved to be the most promising method of
    classification, and the most effort was spent on developing that
    model.</p>
    <sec id="random-forest-model-development">
      <title>2.5.1 Random Forest Model Development</title>
      <p>Over 400 RF models were tested for the San Pedro watershed.
      Model optimization parameters tested included the number of trees,
      the number of sampling points (from 20,000 up to 60,000), and
      combinations of explanatory variables. Many RF models were tested
      simultaneously with between 5 to 100 trees using a custom GEE
      function modified from Nicolau et al.
      (<xref alt="2023" rid="ref-EEFA_F2.2" ref-type="bibr">2023</xref>).
      The referenced accuracy scores for preliminary models refers to
      the most accurate model, using the fewest number of trees. Tested
      RF models ranged from 73.9% to 87.4%
      (<xref alt="Table 1" rid="tbl-rfAcc">Table 1</xref>). The most
      accurate model tested used 35,000 sampling points, consisting of
      30,000 dry land points (not flooded) and 5,000 flooded points and
      with all explanatory variables except for TRI, achieving a peak
      overall accuracy of 87.4% at 70 trees.</p>
      <fig id="tbl-rfAcc">
        <caption><p>Table 1: Random Forest algorithm optimization and
        accuracy. All recorded sampling points were grouped together
        before being partitioned into a 70:30::training:testing
        structure.</p></caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="30%" />
              <col width="30%" />
              <col width="12%" />
              <col width="28%" />
            </colgroup>
            <thead>
              <tr>
                <th>Variables</th>
                <th>Sampling Points (dry land, flooded)</th>
                <th>Trees</th>
                <th>Accuracy (%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>All</td>
                <td>15000, 5000</td>
                <td>50</td>
                <td>79.2</td>
              </tr>
              <tr>
                <td>All</td>
                <td>20000, 5000</td>
                <td>85</td>
                <td>82</td>
              </tr>
              <tr>
                <td>All</td>
                <td>20000, 10000</td>
                <td>85</td>
                <td>73.9</td>
              </tr>
              <tr>
                <td>All</td>
                <td>25000, 5000</td>
                <td>50</td>
                <td>84.8</td>
              </tr>
              <tr>
                <td>All</td>
                <td>30000, 5000</td>
                <td>45</td>
                <td>87</td>
              </tr>
              <tr>
                <td>All</td>
                <td>30000, 10000</td>
                <td>80</td>
                <td>78.9</td>
              </tr>
              <tr>
                <td>All</td>
                <td>40000, 10000</td>
                <td>50</td>
                <td>82.1</td>
              </tr>
              <tr>
                <td>All</td>
                <td>50000, 10000</td>
                <td></td>
                <td>Error</td>
              </tr>
              <tr>
                <td>No TRI</td>
                <td>25000, 5000</td>
                <td>90</td>
                <td>84.9</td>
              </tr>
              <tr>
                <td>No slope</td>
                <td>25000, 5000</td>
                <td>70</td>
                <td>84.8</td>
              </tr>
              <tr>
                <td>No TRI</td>
                <td>30000, 5000</td>
                <td>70</td>
                <td>87.4</td>
              </tr>
              <tr>
                <td>No TRI or STI</td>
                <td>30000, 5000</td>
                <td>40</td>
                <td>87.2</td>
              </tr>
              <tr>
                <td>No STI</td>
                <td>30000, 5000</td>
                <td>??</td>
                <td>87.1</td>
              </tr>
              <tr>
                <td>No elev</td>
                <td>30000, 5000</td>
                <td>90</td>
                <td>86.3</td>
              </tr>
              <tr>
                <td>No slope</td>
                <td>30000, 5000</td>
                <td>80</td>
                <td>87.2</td>
              </tr>
              <tr>
                <td>No aspec</td>
                <td>30000, 5000</td>
                <td>60</td>
                <td>87</td>
              </tr>
              <tr>
                <td>No curve</td>
                <td>30000, 5000</td>
                <td>40</td>
                <td>87.1</td>
              </tr>
              <tr>
                <td>No SPI</td>
                <td>30000, 5000</td>
                <td>70</td>
                <td>87.1</td>
              </tr>
              <tr>
                <td>No TWI</td>
                <td>30000, 5000</td>
                <td>40</td>
                <td>87.1</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
      <p>Confusion matrix analysis for this model showed a much higher
      producers accuracy (98.6%) than consumers accuracy (88.1%;
      <xref alt="Table 2" rid="tbl-confusion1">Table 2</xref>). While
      these results are still satisfactory, they reveal that the model
      is generally favoring dry land classification over flooded. This
      can be explained by the relative abundance of dry land pixels
      vs. flooded pixels, both in the sampling points and across the
      landscape. Qualitatively, the model appeared to be overfit to
      stream channels. While many of the larger flood plains were
      effectively captured, flooded features generally appeared too
      narrow, especially along smaller tributaries. Additionally, the
      results were quite noisy, with noticeable speckling in both the
      dry and flooded regions
      (<xref alt="Figure 4" rid="fig-modelCompare">Figure 4</xref>
      B).</p>
      <fig id="tbl-confusion1">
        <caption><p>Table 2: The confusion matrix for the most accurate
        random forest classifier of the San Pedro watershed, including
        overall, producer’s and consumer’s accuracy.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/Confusion1.png" />
      </fig>
      <fig id="fig-modelCompare">
        <caption><p>Figure 4: Side-by-side comparison of FEMA 100-year
        flood maps (A), raw random forest classification (B),
        post-processed random forest classification (C), and
        classification errors of the post-processed classification (D)
        for the lower San Pedro watershed.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/SanPedro_modelCompare.png" />
      </fig>
    </sec>
    <sec id="post-processing">
      <title>2.5.2 Post-Processing</title>
      <p>To clean up the RF classification, and further increase its
      overall accuracy, I post-processed the classification image using
      a two step process. Firstly, pixel “connectedness” was measured,
      with pixel groups of 20 or fewer connected pixels (D8)
      reclassified to 0 (dry land). This process was very effective at
      removing the speckling, where small pockets were being incorrectly
      classified as flooded. Secondly, all remaining flooded areas were
      dilated using a focal maximum function using a square kernel with
      a 90 m radius (7x7 pixel neighborhood). This both removed noise
      within the flooded areas, and widened the flood zone along long,
      thin features, such as tributaries
      (<xref alt="Figure 4" rid="fig-modelCompare">Figure 4</xref> C).
      This process did increase the overall rate of commission errors
      (incorrectly classifying as flooded), particularly along the banks
      of major floodplains, however the decreased rate of omission
      errors (incorrectly classifying as not flooded) more than made up
      for this fact, and the overall accuracy increased to 90.5%
      (<xref alt="Figure 4" rid="fig-modelCompare">Figure 4</xref> D;
      <xref alt="Table 3" rid="tbl-confusion2">Table 3</xref>)</p>
      <fig id="tbl-confusion2">
        <caption><p>Table 3: The confusion matrix for the post-processed
        random forest classifier of the San Pedro watershed, including
        overall, producer’s and consumer’s accuracy.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/Confusion2.png" />
      </fig>
    </sec>
  </sec>
  <sec id="scaling-up">
    <title>2.6 Scaling up</title>
    <p>The chosen RF classification, with post-processing was then
    applied to the larger ATUR study area, encompassing AZ. The same
    number of sample points were used and they retained the same
    structure (i.e. dry, flooded, and training, testing), however the
    sample locations were adjusted to the larger study area. The overall
    accuracy of the raw model output measured 86.9%
    (<xref alt="Table 4" rid="tbl-confusion3">Table 4</xref>).
    Unfortunately, while the dilated model was successful and has been
    exported from GEE, the associated accuracy assessment timed out and
    will have to be completed as a secondary process either within GEE
    or using external software. Final accuracy assessment of the dilated
    model is pending.</p>
    <fig id="tbl-confusion3">
      <caption><p>Table 4: The confusion matrix for the random forest
      classifier of the full ATUR study area, encompassing Arizona,
      including overall, producer’s and consumer’s
      accuracy.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="images/Confusion3.png" />
    </fig>
  </sec>
  <sec id="combining-data-sets">
    <title>2.7 Combining Data Sets</title>
    <p>Using the newly developed RF classification the FEMA flood map
    can be augmented and extended to continuous coverage of Arizona.
    Assuming that the FEMA data is the more accurate dataset, it is
    given priority. The RF data is then used where no FEMA data exists.
    Additionally, classification error maps are generated as the
    difference between the RF classification, and the FEMA
    classification. These data layers are available for use by the ATUR
    project participants in the associated
    <ext-link ext-link-type="uri" xlink:href="https://uagis.maps.arcgis.com/home/group.html?id=f76541c22acb40e8948d9d246b8611c5#overview">ArcGIS
    online (AGOL) group</ext-link>.</p>
  </sec>
</sec>
<sec id="conclusion">
  <title>3 Conclusion</title>
  <p>A state-wide binary classification of flooded areas, for a 100-year
  flood event, has be generated through the combination of high quality
  FEMA data, and a machine learning RF classification algorithm used to
  complement and extend the FEMA data. The classification was carried
  out using 7 topographic explanatory variables, achieving an overall
  accuracy of at least 86.9% (final accuracy assessment pending). These
  newly developed data layers are appropriate for use within the ATUR
  project, for such analysis as Flood-MAR. Further, I am unaware of any
  other continuous flood maps for the state of AZ, making this work
  novel and potentially useful outside of the ATUR group. While
  improvements could certainly be made to this model, accuracy
  approaching (or exceeding) 90% is laudable, and these datasets may
  warrant external publication, pending approval.</p>
  <p>Full project code available on
  <ext-link ext-link-type="uri" xlink:href="https://code.earthengine.google.com/4a9b1dba779c649e0b79578d595d2ff5">GEE</ext-link>.</p>
</sec>
<sec id="references">
  <title>References</title>
</sec>
<sec id="appendix">
  <title>4 Appendix</title>
  <p>Code used to render these plots, as well as interactive versions of
  these plots are available on
  <ext-link ext-link-type="uri" xlink:href="https://code.earthengine.google.com/5d33d4d4b06092127e3e3c5233878ef3">GEE</ext-link>.</p>
  <p><bold>Flooding</bold></p>
  <fig id="appfig-floodElev">
    <caption><p>A1: Linear regression analysis of flood risk (binary)
    and elevation (m) for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-elev.png" />
  </fig>
  <fig id="appfig-floodSlope">
    <caption><p>A2: Linear regression analysis of flood risk (binary)
    and slope (°) for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-slope.png" />
  </fig>
  <fig id="appfig-floodAspect">
    <caption><p>A3: Linear regression analysis of flood risk (binary)
    and aspect (°) for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-aspect.png" />
  </fig>
  <fig id="appfig-floodCurve">
    <caption><p>A4: Linear regression analysis of flood risk (binary)
    and curvature for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-curve.png" />
  </fig>
  <fig id="appfig-floodSpi">
    <caption><p>A5: Linear regression analysis of flood risk (binary)
    and stream power index (SPI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-spi.png" />
  </fig>
  <fig id="appfig-floodTwi">
    <caption><p>A6: Linear regression analysis of flood risk (binary)
    and topographic wetness index (TWI) for 5,000 randomly sampled
    points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-twi.png" />
  </fig>
  <fig id="appfig-floodTri">
    <caption><p>A7: Linear regression analysis of flood risk (binary)
    and topographic roughness index (TRI) for 5,000 randomly sampled
    points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-tri.png" />
  </fig>
  <fig id="appfig-floodSti">
    <caption><p>A8: Linear regression analysis of flood risk (binary)
    and sediment transport index (STI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/flood-sti.png" />
  </fig>
  <p><bold>Elevation</bold></p>
  <fig id="appfig-elevSlope">
    <caption><p>A9: Linear regression analysis of elevation (m) and
    slope (°) for 5,000 randomly sampled points across the full study
    area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-slope.png" />
  </fig>
  <fig id="appfig-elevAspect">
    <caption><p>A10: Linear regression analysis of elevation (m) and
    aspect (°) for 5,000 randomly sampled points across the full study
    area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-aspect.png" />
  </fig>
  <fig id="appfig-elevCurve">
    <caption><p>A11: Linear regression analysis of elevation (m) and
    curvature for 5,000 randomly sampled points across the full study
    area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-curve.png" />
  </fig>
  <fig id="appfig-elevSpi">
    <caption><p>A12: Linear regression analysis of elevation (m) and
    stream power index (SPI) for 5,000 randomly sampled points across
    the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-spi.png" />
  </fig>
  <fig id="appfig-elevTwi">
    <caption><p>A13: Linear regression analysis of elevation (m) and
    topographic wetness index (TWI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-twi.png" />
  </fig>
  <fig id="appfig-elevTri">
    <caption><p>A14: Linear regression analysis of elevation (m) and
    topographic roughness index (TRI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-tri.png" />
  </fig>
  <fig id="appfig-elevSti">
    <caption><p>A15: Linear regression analysis of elevation (m) and
    sediment transport index (STI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/elev-sti.png" />
  </fig>
  <p><bold>Slope</bold></p>
  <fig id="appfig-slopeAspect">
    <caption><p>A16: Linear regression analysis of slope (°) and aspect
    (°) for 5,000 randomly sampled points across the full study area,
    encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/slope-aspect.png" />
  </fig>
  <fig id="appfig-slopeCurve">
    <caption><p>A17: Linear regression analysis of slope (°) and
    curvature for 5,000 randomly sampled points across the full study
    area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/slope-curve.png" />
  </fig>
  <fig id="appfig-slopeSpi">
    <caption><p>A18: Linear regression analysis of slope (°) and stream
    power index (SPI) for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/slope-spi.png" />
  </fig>
  <fig id="appfig-slopeTwi">
    <caption><p>A19: Linear regression analysis of slope (°) and
    topographic wetness index (TWI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/slope-twi.png" />
  </fig>
  <fig id="appfig-slopeTri">
    <caption><p>A20: Linear regression analysis of slope (°) and
    topographic roughness index (TRI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/slope-tri.png" />
  </fig>
  <fig id="appfig-slopeSti">
    <caption><p>A21: Linear regression analysis of slope (°) and
    sediment transport index (STI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/slope-sti.png" />
  </fig>
  <p><bold>Aspect</bold></p>
  <fig id="appfig-aspectCurve">
    <caption><p>A22: Linear regression analysis of aspect (°) and
    curvature for 5,000 randomly sampled points across the full study
    area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/aspect-curve.png" />
  </fig>
  <fig id="appfig-aspectSpi">
    <caption><p>A23: Linear regression analysis of aspect (°) and stream
    power index (SPI) for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/aspect-spi.png" />
  </fig>
  <fig id="appfig-aspectTwi">
    <caption><p>A24: Linear regression analysis of aspect (°) and
    topographic wetness index (TWI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/aspect-twi.png" />
  </fig>
  <fig id="appfig-aspectTri">
    <caption><p>A25: Linear regression analysis of aspect (°) and
    topographic roughness index (TRI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/aspect-tri.png" />
  </fig>
  <fig id="appfig-aspectSti">
    <caption><p>A26: Linear regression analysis of aspect (°) and
    sediment transport index (STI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/aspect-sti.png" />
  </fig>
  <p><bold>Curvature</bold></p>
  <fig id="appfig-curveSpi">
    <caption><p>A27: Linear regression analysis of curvature and stream
    power index (SPI) for 5,000 randomly sampled points across the full
    study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/curve-spi.png" />
  </fig>
  <fig id="appfig-curveTwi">
    <caption><p>A28: Linear regression analysis of curvature and
    topographic wetness index (TWI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/curve-twi.png" />
  </fig>
  <fig id="appfig-curveTri">
    <caption><p>A29: Linear regression analysis of curvature and
    topographic roughness index (TRI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/curve-tri.png" />
  </fig>
  <fig id="appfig-curveSti">
    <caption><p>A30: Linear regression analysis of curvature and
    sediment transport index (STI) for 5,000 randomly sampled points
    across the full study area, encompassing Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/curve-sti.png" />
  </fig>
  <p><bold>Stream Power Index</bold></p>
  <fig id="appfig-spiTwi">
    <caption><p>A31: Linear regression analysis of stream power index
    (SPI) and topographic wetness index (TWI) for 5,000 randomly sampled
    points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/spi-twi.png" />
  </fig>
  <fig id="appfig-spiTri">
    <caption><p>A32: Linear regression analysis of stream power index
    (SPI) and topographic roughness index (TRI) for 5,000 randomly
    sampled points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/spi-tri.png" />
  </fig>
  <fig id="appfig-spiSti">
    <caption><p>A33: Linear regression analysis of stream power index
    (SPI) and sediment transport index (STI) for 5,000 randomly sampled
    points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/spi-sti.png" />
  </fig>
  <p><bold>Topographic Wetness Index</bold></p>
  <fig id="appfig-twiTri">
    <caption><p>A34: Linear regression analysis of topographic wetness
    index (TWI) and topographic roughness index (TRI) for 5,000 randomly
    sampled points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/twi-tri.png" />
  </fig>
  <fig id="appfig-twiSti">
    <caption><p>A35: Linear regression analysis of topographic wetness
    index (TRI) and sediment transport index (STI) for 5,000 randomly
    sampled points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/tri-sti.png" />
  </fig>
  <p><bold>Topographic Roughness Index</bold></p>
  <fig id="appfig-triSti">
    <caption><p>A36: Linear regression analysis of topographic roughness
    index (TRI) and sediment transport index (STI) for 5,000 randomly
    sampled points across the full study area, encompassing
    Arizona.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/Collinearity/tri-sti.png" />
  </fig>
</sec>
</body>

<back>
<ref-list>
  <title></title>
  <ref id="ref-Tehrany_Jones_Shabani_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tehrany</surname><given-names>Mahyat Shafapour</given-names></name>
        <name><surname>Jones</surname><given-names>Simon</given-names></name>
        <name><surname>Shabani</surname><given-names>Farzin</given-names></name>
      </person-group>
      <article-title>Identifying the essential flood conditioning factors for flood prone area mapping using machine learning techniques</article-title>
      <source>CATENA</source>
      <year iso-8601-date="2019-04">2019</year><month>04</month>
      <volume>175</volume>
      <issn>0341-8162</issn>
      <pub-id pub-id-type="doi">10.1016/j.catena.2018.12.011</pub-id>
      <fpage>174</fpage>
      <lpage>192</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Aloui_Zghibi_Mazzoni_Elomri_Al-Ansari_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Aloui</surname><given-names>Sarra</given-names></name>
        <name><surname>Zghibi</surname><given-names>Adel</given-names></name>
        <name><surname>Mazzoni</surname><given-names>Annamaria</given-names></name>
        <name><surname>Elomri</surname><given-names>Adel</given-names></name>
        <name><surname>Al-Ansari</surname><given-names>Tareq</given-names></name>
      </person-group>
      <article-title>Identifying suitable zones for integrated aquifer recharge and flood control in arid qatar using GIS-based multi-criteria decision-making</article-title>
      <year iso-8601-date="2024-05">2024</year><month>05</month>
      <volume>25</volume>
      <issn>2352-801X</issn>
      <pub-id pub-id-type="doi">10.1016/j.gsd.2024.101137</pub-id>
      <fpage>101137</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Mudashiru_Sabtu_Abustan_Balogun_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mudashiru</surname><given-names>Rofiat Bunmi</given-names></name>
        <name><surname>Sabtu</surname><given-names>Nuridah</given-names></name>
        <name><surname>Abustan</surname><given-names>Ismail</given-names></name>
        <name><surname>Balogun</surname><given-names>Waheed</given-names></name>
      </person-group>
      <article-title>Flood hazard mapping methods: A review</article-title>
      <source>Journal of Hydrology</source>
      <year iso-8601-date="2021-12">2021</year><month>12</month>
      <volume>603</volume>
      <issn>0022-1694</issn>
      <pub-id pub-id-type="doi">10.1016/j.jhydrol.2021.126846</pub-id>
      <fpage>126846</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-EEFA_F2.2">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Nicolau</surname><given-names>Andréa Puzzi</given-names></name>
        <name><surname>Dyson</surname><given-names>Karen</given-names></name>
        <name><surname>Saah</surname><given-names>David</given-names></name>
        <name><surname>Clinton</surname><given-names>Nicholas</given-names></name>
      </person-group>
      <article-title>Chapter F2.2: Accuracy assessment: Quantifying classification quality</article-title>
      <source>Cloud-based remote sensing with google earth engine: Fundamentals and applications</source>
      <person-group person-group-type="editor">
        <name><surname>Cardille</surname><given-names>Jeffrey A.</given-names></name>
        <name><surname>Clinton</surname><given-names>Nick</given-names></name>
        <name><surname>Crowley</surname><given-names>Morgan A</given-names></name>
        <name><surname>Saah</surname><given-names>David</given-names></name>
      </person-group>
      <publisher-name>Springer Cham</publisher-name>
      <year iso-8601-date="2023-05">2023</year><month>05</month>
      <edition>1</edition>
      <isbn>978-3-031-26587-7</isbn>
      <uri>https://docs.google.com/document/d/1UCB900oCdJERca-2WUeDlCu52MjPKJxETJ_jJcLM0bM/edit?tab=t.0</uri>
    </element-citation>
  </ref>
</ref-list>
</back>



</article>